<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.3/vue.js"></script>
</head>


<body>
    <div id="app">

    </div>
    <script>  
        const cities = [
            {
                name: '基隆市',
                area: [
                    { name: '仁愛區', zip: '200' },
                    { name: '信義區', zip: '201' },
                    { name: '中正區', zip: '202' },
                    { name: '中山區', zip: '203' },
                    { name: '安樂區', zip: '204' },
                    { name: '暖暖區', zip: '205' },
                    { name: '七堵區', zip: '206' },
                ]
            },
            {
                name: '台北市',
                area: [
                    { name: '中正區', zip: '100' },
                    { name: '大同區', zip: '101' },
                    { name: '中山區', zip: '102' },
                    { name: '松山區', zip: '103' },
                    { name: '大安區', zip: '104' },
                    { name: '萬華區', zip: '105' },
                    { name: '七堵區', zip: '106' },
                    { name: '信義區', zip: '107' },
                    { name: '士林區', zip: '108' },
                    { name: '北投區', zip: '109' },
                    { name: '內湖區', zip: '110' },
                    { name: '南港區', zip: '111' },
                    { name: '文山區', zip: '112' },
                ]
            }
        ]
        Vue.component('Select', {
            props: ['value', 'options'],
            computed: {
                index: {
                    get() {
                        return this.value;
                    },
                    set(val) {
                        this.$emit('input', val)
                    }
                }
            },
            template: `
            <select v-model="index">
                <option v-for="(item,idx) in options" :value="idx">{{item.name}}</option>
            </select>      
            `
        });

        new Vue({
            el: '#app',
            data: {
                cityidx: 0,
                areaidx: 0
            },
            computed: {
                cities() {
                    return cities;
                },
                area() {
                    return cities[this.cityidx].area;
                },
                zipcode() {
                    return cities[this.cityidx].area[this.areaidx].zip
                }
            },
            //當city變動時，area需要歸零
            watch: {
                cityidx() {
                    this.areaidx = 0
                }
            },
            template: `
            <div>
                <Select v-model="cityidx" :options="cities"/>
                <Select v-model="areaidx" :options="area"/>    
                <span>縣市:</span> {{cities[cityidx].name}}  
                <span>區域:</span> {{cities[cityidx].area[areaidx].name}}  
                <span>zipcode:</span> {{zipcode}}  
            </div>
            `

        });
    </script>
</body>

</html>